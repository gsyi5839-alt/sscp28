import{d as E,m as M,r as c,o as D,c as p,a as e,u as w,A as y,w as g,v as m,F as k,l as A,t as _,B as x,E as l,b as F,e as v}from"./index-De2LwMbB.js";import{_ as I}from"./_plugin-vue_export-helper-DlAUqK2U.js";const R="/assets/2-DD4aa5z2.png",S="/assets/1-BIfa7xWN.png",L={class:"login-page"},V={class:"login-container"},U={class:"left-section"},z=["src"],N={class:"form-content"},T={class:"form-row"},W={class:"form-row"},q={class:"form-row"},P={class:"form-row button-row"},$=["disabled"],j=E({__name:"MemberLogin",setup(G){const i=F(),b=M(),s=c({account:"",password:"",captcha:""}),u=c(""),f=["#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#FFEAA7","#DDA0DD"],n=c(""),r=c(!1),d=async()=>{try{const t=await x.getCaptcha();t.code===200&&(u.value=t.data.code,n.value=t.data.token)}catch{u.value="",n.value="",l.error("验证码加载失败")}},B=t=>f[t%f.length],C=async()=>{if(!s.value.account.trim()){l.warning("请输入账号");return}if(!s.value.password.trim()){l.warning("请输入密码");return}if(!s.value.captcha.trim()){l.warning("请输入验证码");return}r.value=!0;try{if(!n.value){l.warning("验证码未加载，请刷新");return}const t=await b.loginWithRole(s.value.account,s.value.password,"MEMBER",n.value,s.value.captcha);if(t.success){if(t.needPasswordChange){i.push("/change-password");return}const a=localStorage.getItem("userAgreementAccepted")==="true";i.push(a?"/game":"/user-agreement")}else{if(t.status===403&&t.errorMessage&&t.errorMessage.includes("账户已停用")){i.push({path:"/force-change-password",query:{role:"MEMBER",username:s.value.account}});return}d(),s.value.captcha=""}}catch{l.error("登录失败，请重试")}finally{r.value=!1}};return D(()=>{document.title="会员登录";const t=document.getElementById("favicon");t&&(t.href="/favicon.png"),d()}),(t,a)=>(v(),p("div",L,[e("div",V,[e("div",U,[e("img",{src:w(R),alt:"Email",class:"left-image"},null,8,z)]),e("div",{class:"right-section",style:y({backgroundImage:`url(${w(S)})`})},[e("div",N,[e("div",T,[a[3]||(a[3]=e("label",{class:"form-label"},"账号：",-1)),g(e("input",{"onUpdate:modelValue":a[0]||(a[0]=o=>s.value.account=o),type:"text",class:"form-input",placeholder:"请输入账号"},null,512),[[m,s.value.account]])]),e("div",W,[a[4]||(a[4]=e("label",{class:"form-label"},"密码：",-1)),g(e("input",{"onUpdate:modelValue":a[1]||(a[1]=o=>s.value.password=o),type:"password",class:"form-input",placeholder:"请输入密码"},null,512),[[m,s.value.password]])]),e("div",q,[a[5]||(a[5]=e("label",{class:"form-label"},"验证码：",-1)),g(e("input",{"onUpdate:modelValue":a[2]||(a[2]=o=>s.value.captcha=o),type:"text",class:"form-input captcha-input",placeholder:"验证码",maxlength:"4"},null,512),[[m,s.value.captcha]]),e("div",{class:"captcha-display",onClick:d},[(v(!0),p(k,null,A(u.value,(o,h)=>(v(),p("span",{key:h,class:"captcha-char",style:y({color:B(h)})},_(o),5))),128))])]),e("div",P,[e("button",{class:"login-btn",disabled:r.value,onClick:C},_(r.value?"...":"登录"),9,$)])]),a[6]||(a[6]=e("div",{class:"divider"},null,-1))],4)]),a[7]||(a[7]=e("div",{class:"footer"},[e("div",{class:"footer-line"}),e("p",{class:"copyright"},"Copyright © Microsoft 2024")],-1))]))}}),K=I(j,[["__scopeId","data-v-2cc56625"]]);export{K as default};
