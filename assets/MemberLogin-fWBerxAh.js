import{d as D,m as E,r as c,o as k,c as d,a,u as w,A as y,w as p,v,F as M,l as x,t as _,B as F,E as o,b as A,e as g}from"./index-Bxis9ZRH.js";import{_ as I}from"./_plugin-vue_export-helper-DlAUqK2U.js";const L="/assets/2-DD4aa5z2.png",R="/assets/1-BIfa7xWN.png",S={class:"login-page"},V={class:"login-container"},U={class:"left-section"},z=["src"],N={class:"form-content"},T={class:"form-row"},W={class:"form-row"},P={class:"form-row"},$={class:"form-row button-row"},j=["disabled"],q=D({__name:"MemberLogin",setup(G){const f=A(),b=E(),e=c({account:"",password:"",captcha:""}),i=c(""),m=["#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#FFEAA7","#DDA0DD"],l=c(""),r=c(!1),u=async()=>{try{const s=await F.getCaptcha();s.code===200&&(i.value=s.data.code,l.value=s.data.token)}catch{i.value="",l.value="",o.error("验证码加载失败")}},C=s=>m[s%m.length],B=async()=>{if(!e.value.account.trim()){o.warning("请输入账号");return}if(!e.value.password.trim()){o.warning("请输入密码");return}if(!e.value.captcha.trim()){o.warning("请输入验证码");return}r.value=!0;try{if(!l.value){o.warning("验证码未加载，请刷新");return}const s=await b.loginWithRole(e.value.account,e.value.password,"MEMBER",l.value,e.value.captcha);if(s.success){if(s.needPasswordChange){const t=s.loginCount||1;t===1?o.warning("⚠️ 首次登录，请修改初始密码"):t===2&&o.warning("⚠️ 这是您第2次登录未修改密码，再次登录未修改将停用账户！"),f.push("/change-password");return}f.push("/user-agreement")}else u(),e.value.captcha=""}catch{o.error("登录失败，请重试")}finally{r.value=!1}};return k(()=>{document.title="会员登录";const s=document.getElementById("favicon");s&&(s.href="/favicon.png"),u()}),(s,t)=>(g(),d("div",S,[a("div",V,[a("div",U,[a("img",{src:w(L),alt:"Email",class:"left-image"},null,8,z)]),a("div",{class:"right-section",style:y({backgroundImage:`url(${w(R)})`})},[a("div",N,[a("div",T,[t[3]||(t[3]=a("label",{class:"form-label"},"账号：",-1)),p(a("input",{"onUpdate:modelValue":t[0]||(t[0]=n=>e.value.account=n),type:"text",class:"form-input",placeholder:"请输入账号"},null,512),[[v,e.value.account]])]),a("div",W,[t[4]||(t[4]=a("label",{class:"form-label"},"密码：",-1)),p(a("input",{"onUpdate:modelValue":t[1]||(t[1]=n=>e.value.password=n),type:"password",class:"form-input",placeholder:"请输入密码"},null,512),[[v,e.value.password]])]),a("div",P,[t[5]||(t[5]=a("label",{class:"form-label"},"验证码：",-1)),p(a("input",{"onUpdate:modelValue":t[2]||(t[2]=n=>e.value.captcha=n),type:"text",class:"form-input captcha-input",placeholder:"验证码",maxlength:"4"},null,512),[[v,e.value.captcha]]),a("div",{class:"captcha-display",onClick:u},[(g(!0),d(M,null,x(i.value,(n,h)=>(g(),d("span",{key:h,class:"captcha-char",style:y({color:C(h)})},_(n),5))),128))])]),a("div",$,[a("button",{class:"login-btn",disabled:r.value,onClick:B},_(r.value?"...":"登录"),9,j)])]),t[6]||(t[6]=a("div",{class:"divider"},null,-1))],4)]),t[7]||(t[7]=a("div",{class:"footer"},[a("div",{class:"footer-line"}),a("p",{class:"copyright"},"Copyright © Microsoft 2024")],-1))]))}}),K=I(q,[["__scopeId","data-v-62d81bda"]]);export{K as default};
