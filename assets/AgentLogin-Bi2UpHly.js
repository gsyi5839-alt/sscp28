import{d as A,m as E,r as c,o as D,c as p,a,u as w,A as y,w as v,v as g,F as k,l as F,t as _,B as x,E as l,b as I,e as f}from"./index-De2LwMbB.js";import{_ as M}from"./_plugin-vue_export-helper-DlAUqK2U.js";const L="/assets/1-DVbLImah.png",V="/assets/2-BG0Op9j-.png",S={class:"login-page"},T={class:"login-container"},G={class:"left-section"},N=["src"],R={class:"form-content"},U={class:"form-row"},j={class:"form-row"},q={class:"form-row"},z={class:"form-row button-row"},O=["disabled"],P=A({__name:"AgentLogin",setup(W){const i=I(),b=E(),t=c({account:"",password:"",captcha:""}),u=c(""),m=["#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#FFEAA7","#DDA0DD"],n=c(""),r=c(!1),d=async()=>{try{const e=await x.getCaptcha();e.code===200&&(u.value=e.data.code,n.value=e.data.token)}catch{u.value="",n.value="",l.error("验证码加载失败")}},C=e=>m[e%m.length],B=async()=>{if(!t.value.account.trim()){l.warning("请输入账号");return}if(!t.value.password.trim()){l.warning("请输入密码");return}if(!t.value.captcha.trim()){l.warning("请输入验证码");return}r.value=!0;try{if(!n.value){l.warning("验证码未加载，请刷新");return}const e=await b.loginWithRole(t.value.account,t.value.password,"AGENT",n.value,t.value.captcha);if(e.success){if(e.needPasswordChange){i.push("/change-password");return}i.push("/game")}else{if(e.status===403&&e.errorMessage&&e.errorMessage.includes("账户已停用")){i.push({path:"/force-change-password",query:{role:"AGENT",username:t.value.account}});return}d(),t.value.captcha=""}}catch{l.error("登录失败，请重试")}finally{r.value=!1}};return D(()=>{document.title="代理登录";const e=document.getElementById("favicon");e&&(e.href="/favicon.png"),d()}),(e,s)=>(f(),p("div",S,[a("div",T,[a("div",G,[a("img",{src:w(L),alt:"Email",class:"left-image"},null,8,N)]),a("div",{class:"right-section",style:y({backgroundImage:`url(${w(V)})`})},[a("div",R,[a("div",U,[s[3]||(s[3]=a("label",{class:"form-label"},"账号：",-1)),v(a("input",{"onUpdate:modelValue":s[0]||(s[0]=o=>t.value.account=o),type:"text",class:"form-input",placeholder:"请输入账号"},null,512),[[g,t.value.account]])]),a("div",j,[s[4]||(s[4]=a("label",{class:"form-label"},"密码：",-1)),v(a("input",{"onUpdate:modelValue":s[1]||(s[1]=o=>t.value.password=o),type:"password",class:"form-input",placeholder:"请输入密码"},null,512),[[g,t.value.password]])]),a("div",q,[s[5]||(s[5]=a("label",{class:"form-label"},"验证码：",-1)),v(a("input",{"onUpdate:modelValue":s[2]||(s[2]=o=>t.value.captcha=o),type:"text",class:"form-input captcha-input",placeholder:"验证码",maxlength:"4"},null,512),[[g,t.value.captcha]]),a("div",{class:"captcha-display",onClick:d},[(f(!0),p(k,null,F(u.value,(o,h)=>(f(),p("span",{key:h,class:"captcha-char",style:y({color:C(h)})},_(o),5))),128))])]),a("div",z,[a("button",{class:"login-btn",disabled:r.value,onClick:B},_(r.value?"...":"登录"),9,O)])]),s[6]||(s[6]=a("div",{class:"divider"},null,-1))],4)]),s[7]||(s[7]=a("div",{class:"footer"},[a("div",{class:"footer-line"}),a("p",{class:"copyright"},"Copyright © Microsoft 2024")],-1))]))}}),J=M(P,[["__scopeId","data-v-2ee1072f"]]);export{J as default};
